import { removeUndefineds } from '@olivierpascal/helpers';

import type {
  IComponentThemeFactoryPayload,
  IWithAsProp,
} from '~/utils/component';
import type { IBoxProps } from './Box.types';

export type IExtractBoxPropsForwardedProps<TForwardedComponentProps> = Omit<
  TForwardedComponentProps,
  keyof IBoxProps | keyof IComponentThemeFactoryPayload | keyof IWithAsProp
>;

export interface IExtractBoxPropsResult<TForwardedComponentProps> {
  boxProps?: IBoxProps;
  other: IExtractBoxPropsForwardedProps<TForwardedComponentProps>;
}

export const extractBoxProps = <TForwardedComponentProps>(
  props: IBoxProps,
): IExtractBoxPropsResult<TForwardedComponentProps> => {
  const {
    className,
    style,
    interactions,
    modifiers,
    scale,
    density,
    hiddenFrom,
    visibleFrom,
    m,
    mt,
    mb,
    ml,
    mr,
    ms,
    mx,
    my,
    p,
    pt,
    pb,
    pl,
    pr,
    ps,
    pe,
    px,
    py,
    bd,
    bg,
    c,
    opacity,
    ff,
    fz,
    lts,
    ta,
    lh,
    fs,
    tt,
    td,
    w,
    miw,
    maw,
    h,
    mih,
    mah,
    bgsz,
    bgp,
    bgr,
    bga,
    pos,
    top,
    left,
    bottom,
    right,
    inset,
    display,
    flex,
    br,
    z,
    grow,
    shrink,
    ...other
  } = props;

  const boxProps: IBoxProps = removeUndefineds({
    className,
    style,
    interactions,
    modifiers,
    scale,
    density,
    hiddenFrom,
    visibleFrom,
    m,
    mt,
    mb,
    ml,
    mr,
    ms,
    mx,
    my,
    p,
    pt,
    pb,
    pl,
    pr,
    ps,
    pe,
    px,
    py,
    bd,
    bg,
    c,
    opacity,
    ff,
    fz,
    lts,
    ta,
    lh,
    fs,
    tt,
    td,
    w,
    miw,
    maw,
    h,
    mih,
    mah,
    bgsz,
    bgp,
    bgr,
    bga,
    pos,
    top,
    left,
    bottom,
    right,
    inset,
    display,
    flex,
    br,
    z,
    grow,
    shrink,
  });

  return {
    boxProps,
    other: other as IExtractBoxPropsForwardedProps<TForwardedComponentProps>,
  };
};
